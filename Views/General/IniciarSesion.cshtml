@using EduConnect_Front.Dtos
@model EduConnect_Front.Dtos.IniciarSesionDto
@{
    ViewData["Title"] = "Iniciar Sesión";
    Layout = "_Layout";
}
@section Styles {
   
     <link rel="stylesheet" href="~/estilos/inicioSesion.css">
}


<main>
    <section class="left">
        <img src="~/img/InicioSesion.png" alt="Estudiante">
    </section>

    <section class="right">
        <h1 class="visually-hidden">@ViewData["Title"]</h1>
        <form asp-action="IniciarSesion" asp-controller="General" method="post">
            @Html.AntiForgeryToken()

            <input asp-for="NumIdent" type="text" placeholder="NÚMERO DE DOCUMENTO" required class="nombre" />
            <div class="password-container">
                <input asp-for="ContrasUsu" id="passwordInput" type="password" placeholder="CONTRASEÑA" required />
                <span id="togglePassword" class="toggle-password">
                    👁️
                </span>
            </div>

            <button type="submit">INICIAR SESIÓN</button>
        </form>
    </section>
</main>
<!--  Popup de CIERRE DE SESIÓN -->
@if (TempData["CerrarSesion"] != null)
{
    @await Html.PartialAsync("_Popup", new PopupDto
    {
        Tipo = "exito",
        Titulo = "Sesión cerrada",
        Mensaje = TempData["CerrarSesion"] as string
    })

<script>
    // 🔹 Cierra el popup automáticamente después de 3 segundos
    setTimeout(() => {
        const popup = document.querySelector('.modal-fondo');
        if (popup) popup.style.display = 'none';
    }, 3000);
</script>
}
<!-- Popup de REGISTRO EXITOSO -->
@if (TempData["RegisterSuccess"] != null)
{
    @await Html.PartialAsync("_Popup", new PopupDto
    {
        Tipo = "exito",
        Titulo = "Registro exitoso",
        Mensaje = TempData["RegisterSuccess"] as string
    })
}


<!--Popup de ERROR -->
@{
    var errorGeneral = ViewData.ModelState[string.Empty]?.Errors.FirstOrDefault()?.ErrorMessage;
}
@if (!string.IsNullOrEmpty(errorGeneral))
{
    @await Html.PartialAsync("_Popup", new PopupDto
    {
        Tipo = "error",
        Titulo = "Error de inicio de sesión",
        Mensaje = errorGeneral
    })
}

<script>
    document.getElementById("togglePassword").addEventListener("click", function () {
        const pwdInput = document.getElementById("passwordInput");
        if (pwdInput.type === "password") {
            pwdInput.type = "text";
            this.textContent = "🙈"; // cambia el icono
        } else {
            pwdInput.type = "password";
            this.textContent = "👁️"; // vuelve al ojo
        }
    });
</script>
