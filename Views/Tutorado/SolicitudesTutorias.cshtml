@model List<EduConnect_Front.Dtos.SolicitudTutoriaDto>
@using EduConnect_Front.Dtos
@{
    ViewData["Title"] = "Solicitudes de Tutorías";
    Layout = "_Layout";
    var usuario = ViewBag.Usuario as ObtenerUsuarioDto;
}
@section Styles {
    <link rel="stylesheet" href="~/estilos/HistorialTutorias.css" />
}

<main class="historial historial2">


    <div class="cabecera cabecera2">
        <h1>SOLICITUDES DE TUTORÍAS</h1>
    </div>

    <section class="contenido">
        <div class="tabla-wrapper">
            <table class="tabla tabla2">
                <thead>
                    <tr>
                        <th>Nombre del tutor</th>
                        <th>Materia solicitada</th>
                        <th>Fecha propuesta</th>
                        <th>Hora Propuesta</th>
                        <th>Tema requerido</th>
                        <th>Estado</th>
                    </tr>
                </thead>
                <tbody>
                    @if (Model != null && Model.Any())
                    {
                        foreach (var r in Model)
                        {
                            <tr>
                                <td>@r.NombreTutor</td>
                                <td>@r.MateriaSolicitada</td>
                                <td>@r.FechaPropuesta.ToShortDateString()</td>
                                <td>@r.HoraPropuesta</td>
                                <td>@r.TemaRequerido</td>
                                <td>@r.Estado</td>
                            </tr>
                        }
                    }
                    else
                    {
                        <tr>
                            <td colspan="6" style="text-align:center; padding:18px;">
                                No hay solicitudes registradas.
                            </td>
                        </tr>
                    }
                </tbody>
            </table>

            <a asp-controller="Tutorado" asp-action="PanelTutorado" class="btn-volver btn2">
               VOLVER
            </a>
        </div>

        <aside class="lateral">
            <div class="ilustracion">
                <img src="~/img/PensarSolicitud.png" alt="Usuario">
            </div>

            <!-- 🔹 Formulario que envía el filtro -->
            <form asp-action="SolicitudesTutorias" method="post">
                <div class="filtros tarjeta">
                    <h3>FILTRAR POR:</h3>

                    <label class="chk">
                        <input type="checkbox" name="Estados" value="4"/>
                        <span class="tick"></span>
                        PENDIENTE DE RESPUESTA
                    </label>

                    <label class="chk">
                        <input type="checkbox" name="Estados" value="3" />
                        <span class="tick"></span>
                        ACEPTADA
                    </label>

                    <label class="chk">
                        <input type="checkbox" name="Estados" value="5" />
                        <span class="tick"></span>
                        RECHAZADA
                    </label>

                    <button type="submit" class="btn-aplicar btn-aplicar2">APLICAR FILTRO</button>
                </div>
            </form>
        </aside>

    </section>

    <button class="btn-flotante" title="Soporte">
        <img src="~/img/chat-bubble.png" alt="Chat">
    </button>

    @* Popup de error si algo falló *@
    @{
        var error = ViewData.ModelState[string.Empty]?.Errors.FirstOrDefault()?.ErrorMessage;
    }
    @await Html.PartialAsync("_Popup", new EduConnect_Front.Dtos.PopupDto {
    Tipo = "error",
        Titulo = "No se pudo cargar el historial",
        Mensaje = error
        })
</main>

